(this.webpackJsonpwakumono=this.webpackJsonpwakumono||[]).push([[9],{1052:function(e,t){},1059:function(e,t){},1061:function(e,t){},1071:function(e,t){},1073:function(e,t){},1111:function(e,t){},1113:function(e,t){},1120:function(e,t){},1121:function(e,t){},1140:function(e,t){},1179:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),s=n(193),c=n.n(s),o=(n(594),n(256));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=n(29);c.a.render(Object(i.jsx)(a.a.StrictMode,{children:Object(i.jsx)(o.b,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},139:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return u}));var r=n(60),a=n(26),s=n(17),c=n(1),o={addressBook:{},reverseAddressBook:{},messageList:[]},i=function(e,t){switch(t.type){case"SET_WEB3":return Object(s.a)(Object(s.a)({},e),{},{web3:t.payload.web3});case"START_WAKU":return Object(s.a)(Object(s.a)({},e),{},{waku:t.payload.waku});case"SET_ADDRESS":return Object(s.a)(Object(s.a)({},e),{},{address:t.payload.address});case"SET_ONBOARD":return Object(s.a)(Object(s.a)({},e),{},{onboard:t.payload.onboard});case"SET_KEYS":return Object(s.a)(Object(s.a)({},e),{},{keys:t.payload.keys});case"ADD_PEER":var n=Object(a.a)({},Object.values(t.payload)[0],Object.keys(t.payload)[0]);return Object(s.a)(Object(s.a)({},e),{},{addressBook:Object(s.a)(Object(s.a)({},e.addressBook),t.payload),reverseAddressBook:Object(s.a)(Object(s.a)({},e.reverseAddressBook),n)});case"ADD_MESSAGE":return Object(s.a)(Object(s.a)({},e),{},{messageList:[].concat(Object(r.a)(e.messageList),[t.payload])});default:return e}},u=n.n(c).a.createContext({state:o,dispatch:function(){return null}})},164:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(0),a=n.n(r),s=n(27),c=n(78),o=function(e){return e?e.substring(0,4)+"..."+e.substring(e.length-4):"Unknown Sender"},i=function(){var e=Object(s.a)(a.a.mark((function e(t,n,r){var s,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={message:r,childSig:c.a.sign(t.privateKey,c.a.hash.keccak256(r))},e.next=3,c.a.encryptWithPublicKey(n,JSON.stringify(s));case 3:return o=e.sent,e.abrupt("return",c.a.cipher.stringify(o));case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},256:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return B}));var r,a=n(26),s=n(0),c=n.n(s),o=n(27),i=n(20),u=n(1187),d=n(1188),l=n(1186),p=n(171),b=n(574),f=n(198),j=n(1189),h=n(551),v=n(255),y=n(196),k=n(1),O=n.n(k),g=n(558),x=n(139),m=n(78),w=n(566),S=n(567),A=n(164),E=n(29),B="wakumono/dm",C="wakumono/broadcast";t.b=function(){var t=O.a.useReducer(x.c,x.b),n=Object(i.a)(t,2),s=n[0],k=n[1],T=Object(u.a)(),D=function(){var e=Object(o.a)(c.a.mark((function e(t){var n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.payload&&s.keys&&s.reverseAddressBook)){e.next=14;break}return e.prev=1,e.next=4,m.a.decryptWithPrivateKey(s.keys.privateKey,m.a.cipher.parse(t.payloadAsUtf8));case 4:n=e.sent,r=JSON.parse(n),a=m.a.recoverPublicKey(r.childSig,m.a.hash.keccak256(r.message)),k({type:"ADD_MESSAGE",payload:{from:s.reverseAddressBook[a],message:r.message}}),T({position:"bottom",title:"Message received from "+Object(A.b)(s.reverseAddressBook[a]),description:r.message,status:"success",duration:3e3,isClosable:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(o.a)(c.a.mark((function e(t){var n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.payload&&s.keys&&s.reverseAddressBook)){e.next=13;break}return e.prev=1,e.next=4,m.a.decryptWithPrivateKey(s.keys.privateKey,m.a.cipher.parse(t.payloadAsUtf8));case 4:n=e.sent,r=JSON.parse(n),a=m.a.recoverPublicKey(r.childSig,m.a.hash.keccak256(r.message)),k({type:"ADD_MESSAGE",payload:{from:null!==a&&void 0!==a?a:"unknown sender",message:r.message}}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(o.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{(n=JSON.parse(t.payloadAsUtf8)).chatKey&&k({type:"ADD_PEER",payload:Object(a.a)({},n.address.toLowerCase(),n.chatKey)})}catch(r){console.log(r)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(o.a)(c.a.mark((function e(t,n){var r,a,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.peerId,!n.protocols.includes(y.a)){e.next=24;break}return e.prev=2,e.next=5,t.store.queryHistory({peerId:r,contentTopics:[C],direction:S.Direction.FORWARD});case 5:if(!(a=e.sent)){e.next=9;break}return e.next=9,a.map((function(e){return _(e)}));case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log("".concat(r.toB58String(),": error encountered when retrieving archived messages"),e.t0);case 14:return e.prev=14,e.next=17,t.store.queryHistory({peerId:r,contentTopics:[B]});case 17:(s=e.sent)&&s.map((function(e){return W(e)})),e.next=24;break;case 21:e.prev=21,e.t1=e.catch(14),console.log("".concat(r.toB58String(),": error encountered when retrieving archived messages"),e.t1);case 24:case"end":return e.stop()}}),e,null,[[2,11],[14,21]])})));return function(t,n){return e.apply(this,arguments)}}(),R=function(){var e=Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.b.create({config:{pubsub:{enabled:!0,emitSelf:!0}}});case 3:(t=e.sent).addPeerToAddressBook("16Uiu2HAmPLe7Mzm8TsYUubgCAW1aJoeFScxrLj8ppHFivPo97bUZ",["/dns4/node-01.do-ams3.jdev.misc.statusim.net/tcp/7010/wss"]),t.addPeerToAddressBook("16Uiu2HAmVkKntsECaYfefR1V2yCR79CegLATuTPE6B9TxgxBiiiA",["/dns4/node-01.gc-us-central1-a.wakuv2.prod.statusim.net/tcp/443/wss/p2p/16Uiu2HAmVkKntsECaYfefR1V2yCR79CegLATuTPE6B9TxgxBiiiA"]),k({type:"START_WAKU",payload:{waku:t}}),t.relay.addObserver(D,[B]),t.relay.addObserver(_,[C]),t.libp2p.peerStore.on("change:protocols",K.bind({},t)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("Issue starting waku ",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var t=Object(o.a)(c.a.mark((function t(){var n,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.getSigner().signMessage("make it so, Number One");case 2:return n=t.sent,t.next=5,m.a.createIdentity(e.from(n));case 5:a=t.sent,k({type:"SET_KEYS",payload:{keys:a}});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),P=function(){var e=Object(o.a)(c.a.mark((function e(){var t,n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.keys){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r.getSigner().signMessage(s.keys.address);case 4:n=e.sent,a=y.c.fromUtf8String(JSON.stringify({address:s.address,chatKey:s.keys.publicKey,signature:n}),C),null===(t=s.waku)||void 0===t||t.relay.send(a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(o.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{walletName:"metamask",preferred:!0},{walletName:"status",preferred:!0}],n=Object(h.a)({networkId:1,subscriptions:{wallet:function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{r=new v.a.providers.Web3Provider(t.provider),k({type:"SET_WEB3",payload:{web3:r}}),L()}catch(n){console.log(n),T({position:"top",status:"error",title:"Something went wrong",description:null===n||void 0===n?void 0:n.toString(),duration:5e3})}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),address:function(e){k({type:"SET_ADDRESS",payload:{address:e}})},balance:function(e){k({type:"SET_BALANCE",payload:{balance:e}})},network:function(e){k({type:"SET_CHAIN",payload:{chain:e}})}},walletSelect:{wallets:t}}),k({type:"SET_ONBOARD",payload:{onboard:n}}),e.prev=3,e.next=6,n.walletSelect();case 6:e.sent,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(3),console.log(e.t0),T({position:"top",status:"error",title:"Something went wrong",description:null===e.t0||void 0===e.t0?void 0:e.t0.toString(),duration:5e3});case 13:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(){return e.apply(this,arguments)}}();return Object(E.jsx)(d.a,{children:Object(E.jsx)(x.a.Provider,{value:{dispatch:k,state:s},children:Object(E.jsx)(l.a,{h:"90vh",children:Object(E.jsxs)(p.b,{children:[Object(E.jsx)(b.a,{children:"WakuMono"}),Object(E.jsxs)(p.a,{children:[Object(E.jsx)(g.a,{handleConnect:U}),Object(E.jsx)(f.a,{disabled:!s.keys,onClick:R,children:"Connect to Waku"}),Object(E.jsx)(f.a,{disabled:void 0!==s.addressBook[s.address],onClick:P,children:"Broadcast Chatkey"})]}),Object(E.jsx)(j.a,{in:void 0!==s.waku,children:Object(E.jsx)(w.a,{})})]})})})})}}).call(this,n(14).Buffer)},301:function(e,t){},558:function(e,t,n){"use strict";var r=n(1),a=n.n(r),s=n(1182),c=n(170),o=n(198),i=n(574),u=n(171),d=n(139),l=n(164),p=n(29);t.a=function(e){var t=e.handleConnect,n=a.a.useContext(d.a),r=n.state,b=n.dispatch;return Object(p.jsx)(s.a,{children:r.address?Object(p.jsxs)(c.a,{placement:"top",children:[Object(p.jsx)(c.g,{children:Object(p.jsx)(o.a,{w:"250px",children:Object(l.b)(r.address)})}),Object(p.jsxs)(c.e,{children:[Object(p.jsx)(c.b,{}),Object(p.jsx)(c.d,{}),Object(p.jsx)(c.f,{children:Object(p.jsx)(i.a,{size:"sm",children:"Wallet Details"})}),Object(p.jsx)(c.c,{children:Object(p.jsx)(u.b,{children:Object(p.jsx)(o.a,{onClick:function(){r.onboard&&(r.onboard.walletReset(),b({type:"SET_ADDRESS",payload:{address:void 0}}),b({type:"SET_WEB3",payload:{web3:void 0}}))},children:"Disconnect Wallet"})})})]})]}):Object(p.jsx)(o.a,{w:"250px",onClick:t,children:"Connect Web3"})})}},566:function(e,t,n){"use strict";var r=n(0),a=n.n(r),s=n(27),c=n(20),o=n(1),i=n.n(o),u=n(171),d=n(575),l=n(198),p=n(1185),b=n(139),f=n(164),j=n(256),h=n(196),v=n(29);t.a=function(){var e=i.a.useContext(b.a),t=e.state,n=(e.dispatch,i.a.useState([])),r=Object(c.a)(n,2),o=r[0],y=r[1],k=i.a.useState(""),O=Object(c.a)(k,2),g=O[0],x=O[1],m=i.a.useState(""),w=Object(c.a)(m,2),S=w[0],A=w[1];i.a.useEffect((function(){var e=t.messageList.length<10?t.messageList:t.messageList.slice(t.messageList.length-11);y(e)}),[t.messageList]);var E=function(){var e=Object(s.a)(a.a.mark((function e(n,r){var s,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.web3&&t.keys){e.next=2;break}return e.abrupt("return");case 2:if(t.addressBook[n.toLowerCase()]){e.next=5;break}return console.log("no address found"),e.abrupt("return");case 5:return e.next=7,Object(f.a)(t.keys,t.addressBook[n.toLowerCase()],r);case 7:c=e.sent,o=h.c.fromUtf8String(c,j.a),null===(s=t.waku)||void 0===s||s.relay.send(o),x("");case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(v.jsxs)(u.b,{children:[Object(v.jsxs)(u.a,{children:[Object(v.jsx)(u.b,{children:Object(v.jsx)(d.a,{value:S,placeholder:"Address",onChange:function(e){return A(e.target.value)}})}),Object(v.jsx)(d.a,{value:g,placeholder:"Enter a message",onChange:function(e){return x(e.target.value)}}),Object(v.jsx)(l.a,{minWidth:"150px",onClick:function(){E(S,g)},children:"Send Message"})]}),o.map((function(e){return Object(v.jsx)(u.a,{align:"start",children:Object(v.jsxs)(p.a,{children:[Object(f.b)(t.reverseAddressBook[e.from]),": ",e.message]})},e.from+Math.random().toFixed(10))}))]})}},594:function(e,t,n){},705:function(e,t){},706:function(e,t){},849:function(e,t){},929:function(e,t){},995:function(e,t){}},[[1179,10,11]]]);
//# sourceMappingURL=main.7c696758.chunk.js.map