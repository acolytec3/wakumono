(this.webpackJsonpwakumono=this.webpackJsonpwakumono||[]).push([[9],{1056:function(e,t){},1122:function(e,t){},1199:function(e,t,a){"use strict";a.r(t);var n=a(1253),r=a(1),s=a.n(r),c=a(195),o=a.n(c),i=a(262);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var u=a(24);o.a.render(Object(u.jsx)(s.a.StrictMode,{children:Object(u.jsx)(n.a,{children:Object(u.jsx)(i.b,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},143:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return u}));var n=a(61),r=a(27),s=a(17),c=a(1),o={addressBook:{},reverseAddressBook:{},messageList:[]},i=function(e,t){switch(t.type){case"SET_WEB3":return Object(s.a)(Object(s.a)({},e),{},{web3:t.payload.web3});case"START_WAKU":return Object(s.a)(Object(s.a)({},e),{},{waku:t.payload.waku});case"SET_ADDRESS":return Object(s.a)(Object(s.a)({},e),{},{address:t.payload.address});case"SET_ONBOARD":return Object(s.a)(Object(s.a)({},e),{},{onboard:t.payload.onboard});case"SET_KEYS":return Object(s.a)(Object(s.a)({},e),{},{keys:t.payload.keys});case"ADD_PEER":var a=Object(r.a)({},Object.values(t.payload)[0],Object.keys(t.payload)[0]);return Object(s.a)(Object(s.a)({},e),{},{addressBook:Object(s.a)(Object(s.a)({},e.addressBook),t.payload),reverseAddressBook:Object(s.a)(Object(s.a)({},e.reverseAddressBook),a)});case"ADD_MESSAGE":return Object(s.a)(Object(s.a)({},e),{},{messageList:[].concat(Object(n.a)(e.messageList),[t.payload])});default:return e}},u=a.n(c).a.createContext({state:o,dispatch:function(){return null}})},168:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return i}));var n=a(0),r=a.n(n),s=a(28),c=a(78),o=function(e){return e?e.substring(0,4)+"..."+e.substring(e.length-4):"Unknown Sender"},i=function(){var e=Object(s.a)(r.a.mark((function e(t,a,n){var s,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={message:n,childSig:c.a.sign(t.privateKey,c.a.hash.keccak256(n))},e.next=3,c.a.encryptWithPublicKey(a,JSON.stringify(s));case 3:return o=e.sent,e.abrupt("return",c.a.cipher.stringify(o));case 5:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()},262:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return E}));var n,r=a(27),s=a(0),c=a.n(s),o=a(28),i=a(20),u=a(1206),d=a(1205),l=a(145),p=a(388),b=a(172),f=a(586),j=a(559),h=a(78),v=a(261),O=a(200),y=a(571),k=a(1),x=a.n(k),g=a(572),w=a(574),m=a(143),S=a(168),A=a(24),E="wakumono/dm",B="wakumono/broadcast";t.b=function(){var t=x.a.useReducer(m.c,m.b),a=Object(i.a)(t,2),s=a[0],k=a[1],C=Object(u.a)(),T=function(){var e=Object(o.a)(c.a.mark((function e(t){var a,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.payload&&s.keys&&s.reverseAddressBook)){e.next=14;break}return e.prev=1,e.next=4,h.a.decryptWithPrivateKey(s.keys.privateKey,h.a.cipher.parse(t.payloadAsUtf8));case 4:a=e.sent,n=JSON.parse(a),r=h.a.recoverPublicKey(n.childSig,h.a.hash.keccak256(n.message)),k({type:"ADD_MESSAGE",payload:{from:s.reverseAddressBook[r],message:n.message}}),C({position:"bottom",title:"Message received from "+Object(S.b)(s.reverseAddressBook[r]),description:n.message,status:"success",duration:3e3,isClosable:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(o.a)(c.a.mark((function e(t){var a,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.payload&&s.keys&&s.reverseAddressBook)){e.next=13;break}return e.prev=1,e.next=4,h.a.decryptWithPrivateKey(s.keys.privateKey,h.a.cipher.parse(t.payloadAsUtf8));case 4:a=e.sent,n=JSON.parse(a),r=h.a.recoverPublicKey(n.childSig,h.a.hash.keccak256(n.message)),k({type:"ADD_MESSAGE",payload:{from:null!==r&&void 0!==r?r:"unknown sender",message:n.message}}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(o.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{(a=JSON.parse(t.payloadAsUtf8)).chatKey&&k({type:"ADD_PEER",payload:Object(r.a)({},a.address.toLowerCase(),a.chatKey)})}catch(n){console.log(n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(o.a)(c.a.mark((function e(t,a){var n,r,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.peerId,!a.protocols.includes(O.a)){e.next=24;break}return e.prev=2,e.next=5,t.store.queryHistory({peerId:n,contentTopics:[B],direction:y.Direction.FORWARD});case 5:if(!(r=e.sent)){e.next=9;break}return e.next=9,r.map((function(e){return W(e)}));case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log("".concat(n.toB58String(),": error encountered when retrieving archived messages"),e.t0);case 14:return e.prev=14,e.next=17,t.store.queryHistory({peerId:n,contentTopics:[E]});case 17:(s=e.sent)&&s.map((function(e){return D(e)})),e.next=24;break;case 21:e.prev=21,e.t1=e.catch(14),console.log("".concat(n.toB58String(),": error encountered when retrieving archived messages"),e.t1);case 24:case"end":return e.stop()}}),e,null,[[2,11],[14,21]])})));return function(t,a){return e.apply(this,arguments)}}(),K=function(){var e=Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.b.create({config:{pubsub:{enabled:!0,emitSelf:!0}}});case 3:(t=e.sent).addPeerToAddressBook("16Uiu2HAmPLe7Mzm8TsYUubgCAW1aJoeFScxrLj8ppHFivPo97bUZ",["/dns4/node-01.do-ams3.jdev.misc.statusim.net/tcp/7010/wss"]),t.addPeerToAddressBook("16Uiu2HAmVkKntsECaYfefR1V2yCR79CegLATuTPE6B9TxgxBiiiA",["/dns4/node-01.gc-us-central1-a.wakuv2.prod.statusim.net/tcp/443/wss/p2p/16Uiu2HAmVkKntsECaYfefR1V2yCR79CegLATuTPE6B9TxgxBiiiA"]),k({type:"START_WAKU",payload:{waku:t}}),t.relay.addObserver(T,[E]),t.relay.addObserver(W,[B]),t.libp2p.peerStore.on("change:protocols",_.bind({},t)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("Issue starting waku ",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var t=Object(o.a)(c.a.mark((function t(){var a,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.getSigner().signMessage("make it so, Number One");case 2:return a=t.sent,t.next=5,h.a.createIdentity(e.from(a));case 5:r=t.sent,k({type:"SET_KEYS",payload:{keys:r}});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),R=function(){var e=Object(o.a)(c.a.mark((function e(){var t,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.keys){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.getSigner().signMessage(s.keys.address);case 4:a=e.sent,r=O.c.fromUtf8String(JSON.stringify({address:s.address,chatKey:s.keys.publicKey,signature:a}),B),null===(t=s.waku)||void 0===t||t.relay.send(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(o.a)(c.a.mark((function e(){var t,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{walletName:"metamask",preferred:!0},{walletName:"status",preferred:!0}],a=Object(j.a)({networkId:1,subscriptions:{wallet:function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n=new v.a.providers.Web3Provider(t.provider),k({type:"SET_WEB3",payload:{web3:n}}),L()}catch(a){console.log(a)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),address:function(e){k({type:"SET_ADDRESS",payload:{address:e}})},balance:function(e){k({type:"SET_BALANCE",payload:{balance:e}})},network:function(e){k({type:"SET_CHAIN",payload:{chain:e}})}},walletSelect:{wallets:t}}),k({type:"SET_ONBOARD",payload:{onboard:a}}),e.prev=3,e.next=6,a.walletSelect();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(){return e.apply(this,arguments)}}();return Object(A.jsx)(m.a.Provider,{value:{dispatch:k,state:s},children:Object(A.jsx)(d.a,{h:"90vh",mw:"95vw",children:Object(A.jsxs)(l.b,{children:[Object(A.jsx)(p.a,{children:"WakuMono"}),Object(A.jsxs)(l.a,{children:[Object(A.jsx)(w.a,{handleConnect:P}),Object(A.jsx)(b.a,{disabled:!s.keys,onClick:K,children:"Connect to Waku"}),Object(A.jsx)(b.a,{disabled:void 0!==s.addressBook[s.address],onClick:R,children:"Broadcast Chatkey"})]}),Object(A.jsx)(f.a,{in:void 0!==s.waku,children:Object(A.jsx)(g.a,{})})]})})})}}).call(this,a(14).Buffer)},330:function(e,t){},572:function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(28),c=a(20),o=a(145),i=a(198),u=a(585),d=a(1202),l=a(586),p=a(1203),b=a(388),f=a(286),j=a(1204),h=a(200),v=a(1),O=a.n(v),y=a(580),k=a(385),x=a.n(k),g=a(262),w=a(143),m=a(168),S=a(24);t.a=function(){var e=O.a.useContext(w.a).state,t=O.a.useState([]),a=Object(c.a)(t,2),n=a[0],v=a[1],A=O.a.useState(""),E=Object(c.a)(A,2),B=E[0],C=E[1],T=O.a.useState(""),D=Object(c.a)(T,2),W=D[0],_=D[1];O.a.useEffect((function(){var t=e.messageList.length<10?e.messageList:e.messageList.slice(e.messageList.length-11);v(t)}),[e.messageList]);var K=function(){var t=Object(s.a)(r.a.mark((function t(a,n){var s,c,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.web3&&e.keys){t.next=2;break}return t.abrupt("return");case 2:if(e.addressBook[a.toLowerCase()]){t.next=5;break}return console.log("no address found"),t.abrupt("return");case 5:return t.next=7,Object(m.a)(e.keys,e.addressBook[a.toLowerCase()],n);case 7:c=t.sent,o=h.c.fromUtf8String(c,g.a),null===(s=e.waku)||void 0===s||s.relay.send(o),C("");case 11:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}();return Object(S.jsxs)(o.b,{mw:"90vw",children:[Object(S.jsxs)(i.a,{minHeight:"100px",isInvalid:""!==W&&void 0===e.addressBook[W],children:[Object(S.jsxs)(o.a,{children:[Object(S.jsx)(u.a,{value:W,placeholder:"Address",onChange:function(e){return _(e.target.value)}}),Object(S.jsx)(u.a,{value:B,placeholder:"Enter a message",onChange:function(e){return C(e.target.value)}}),Object(S.jsx)(d.a,{disabled:void 0===e.addressBook[W.toLowerCase()],onClick:function(){K(W,B)},"aria-label":"send message",icon:Object(S.jsx)(y.a,{}),variant:"outline",colorScheme:"blackAlpha"})]}),Object(S.jsx)(l.a,{in:""!==W&&void 0===e.addressBook[W],children:Object(S.jsx)(p.a,{children:"Address not found"})})]}),Object(S.jsx)(b.a,{children:"Inbox"}),Object(S.jsxs)(o.a,{w:"75vw",spacing:"24px",children:[Object(S.jsx)(f.a,{fontWeight:"bold",w:"150px",children:"Sender"}),Object(S.jsx)(f.a,{fontWeight:"bold",children:"Message"})]}),n.map((function(t){return Object(S.jsxs)(o.a,{w:"75vw",spacing:"24px",children:[Object(S.jsxs)(o.a,{w:"150px",children:[Object(S.jsx)(x.a,{diameter:20,seed:Object(k.jsNumberForAddress)(t.from)}),Object(S.jsx)(j.a,{children:Object(m.b)(e.reverseAddressBook[t.from])})]}),Object(S.jsx)(f.a,{children:t.message})]})}))]})}},574:function(e,t,a){"use strict";var n=a(1),r=a.n(n),s=a(286),c=a(173),o=a(172),i=a(388),u=a(145),d=a(143),l=a(168),p=a(24);t.a=function(e){var t=e.handleConnect,a=r.a.useContext(d.a),n=a.state,b=a.dispatch;return Object(p.jsx)(s.a,{children:n.address?Object(p.jsxs)(c.a,{placement:"top",children:[Object(p.jsx)(c.g,{children:Object(p.jsx)(o.a,{w:"200px",children:Object(l.b)(n.address)})}),Object(p.jsxs)(c.e,{children:[Object(p.jsx)(c.b,{}),Object(p.jsx)(c.d,{}),Object(p.jsx)(c.f,{children:Object(p.jsx)(i.a,{size:"sm",children:"Wallet Details"})}),Object(p.jsx)(c.c,{children:Object(p.jsx)(u.b,{children:Object(p.jsx)(o.a,{onClick:function(){n.onboard&&(n.onboard.walletReset(),b({type:"SET_ADDRESS",payload:{address:void 0}}),b({type:"SET_WEB3",payload:{web3:void 0}}))},children:"Disconnect Wallet"})})})]})]}):Object(p.jsx)(o.a,{w:"200px",onClick:t,children:"Connect Web3"})})}},607:function(e,t){},613:function(e,t){},619:function(e,t){},621:function(e,t){},632:function(e,t){},634:function(e,t){},646:function(e,t){},692:function(e,t){},694:function(e,t){},701:function(e,t){},702:function(e,t){},721:function(e,t){},976:function(e,t){}},[[1199,10,11]]]);
//# sourceMappingURL=main.0cda1aff.chunk.js.map